2025-04-08 06:11:26,983 - Loading data...
2025-04-08 06:11:27,015 - Data loaded, shape: (2506, 5)
2025-04-08 06:11:27,015 - Adding technical indicators...
2025-04-08 06:11:27,065 - Technical indicators added, shape: (2307, 44)
2025-04-08 06:11:27,065 - Preparing features for next_day_direction prediction using pca...
2025-04-08 06:11:27,114 - PCA explained variance with 10 components: 0.96
2025-04-08 06:11:27,114 - Features prepared, training set shape: (1614, 10)
2025-04-08 06:11:27,114 - Training rf model for next_day_direction...
2025-04-08 06:11:27,114 - Performing hyperparameter tuning...
2025-04-08 06:12:00,332 - Best hyperparameters: {'max_depth': 5, 'min_samples_leaf': 4, 'min_samples_split': 2, 'n_estimators': 200}
2025-04-08 06:12:00,332 - Model training complete
2025-04-08 06:12:00,332 - Evaluating model for next_day_direction...

Results for next_day_direction prediction:
Accuracy: 0.4545

Classification Report:
              precision    recall  f1-score   support

           0       0.44      0.80      0.57       314
           1       0.50      0.17      0.25       379

    accuracy                           0.45       693
   macro avg       0.47      0.48      0.41       693
weighted avg       0.48      0.45      0.40       693

2025-04-08 06:12:00,556 - Plotting feature importance...
2025-04-08 06:12:00,676 - Saving model for next_day_direction...
2025-04-08 06:12:00,682 - Model saved to models/Classification/next_day_direction
2025-04-08 06:12:00,682 - Completed next_day_direction prediction using pca
2025-04-08 06:12:00,682 - Preparing features for next_day_direction prediction using select_k_best...
2025-04-08 06:12:00,698 - Selected features: ['return', 'sma_dist', 'sma_20_50_cross', 'sma_20_50_ratio', 'bb_position_20', 'rsi_14', 'rsi_overbought', 'price_vs_20d_low', 'momentum_20d', 'tr']
2025-04-08 06:12:00,698 - Features prepared, training set shape: (1614, 10)
2025-04-08 06:12:00,698 - Training rf model for next_day_direction...
2025-04-08 06:12:00,698 - Performing hyperparameter tuning...
2025-04-08 06:12:28,455 - Best hyperparameters: {'max_depth': 5, 'min_samples_leaf': 2, 'min_samples_split': 5, 'n_estimators': 200}
2025-04-08 06:12:28,455 - Model training complete
2025-04-08 06:12:28,456 - Evaluating model for next_day_direction...

Results for next_day_direction prediction:
Accuracy: 0.5483

Classification Report:
              precision    recall  f1-score   support

           0       0.50      0.28      0.36       314
           1       0.56      0.77      0.65       379

    accuracy                           0.55       693
   macro avg       0.53      0.53      0.51       693
weighted avg       0.54      0.55      0.52       693

2025-04-08 06:12:28,587 - Plotting feature importance...
2025-04-08 06:12:28,771 - Saving model for next_day_direction...
2025-04-08 06:12:28,778 - Model saved to models/Classification/next_day_direction
2025-04-08 06:12:28,778 - Completed next_day_direction prediction using select_k_best
2025-04-08 06:12:28,778 - Preparing features for market_regime prediction using pca...
2025-04-08 06:12:28,787 - PCA explained variance with 10 components: 0.96
2025-04-08 06:12:28,787 - Features prepared, training set shape: (1614, 10)
2025-04-08 06:12:28,787 - Training rf model for market_regime...
2025-04-08 06:12:28,787 - Performing hyperparameter tuning...
2025-04-08 06:12:56,255 - Best hyperparameters: {'max_depth': None, 'min_samples_leaf': 1, 'min_samples_split': 10, 'n_estimators': 200}
2025-04-08 06:12:56,255 - Model training complete
2025-04-08 06:12:56,255 - Evaluating model for market_regime...

Results for market_regime prediction:
Accuracy: 0.8831

Classification Report:
              precision    recall  f1-score   support

           0       0.53      0.88      0.66        49
           1       0.91      0.86      0.88       357
           2       0.96      0.91      0.93       287

    accuracy                           0.88       693
   macro avg       0.80      0.88      0.83       693
weighted avg       0.90      0.88      0.89       693

2025-04-08 06:12:56,399 - Plotting feature importance...
2025-04-08 06:12:56,509 - Saving model for market_regime...
2025-04-08 06:12:56,517 - Model saved to models/Classification/market_regime
2025-04-08 06:12:56,517 - Completed market_regime prediction using pca
2025-04-08 06:12:56,517 - Preparing features for market_regime prediction using select_k_best...
2025-04-08 06:12:56,527 - Selected features: ['sma_dist', 'sma_5_20_cross', 'sma_20_50_cross', 'sma_20_50_ratio', 'bb_position_20', 'rsi_14', 'macd_line', 'macd_signal', 'price_vs_20d_high', 'momentum_20d']
2025-04-08 06:12:56,527 - Features prepared, training set shape: (1614, 10)
2025-04-08 06:12:56,527 - Training rf model for market_regime...
2025-04-08 06:12:56,527 - Performing hyperparameter tuning...
2025-04-08 06:13:14,637 - Best hyperparameters: {'max_depth': 5, 'min_samples_leaf': 2, 'min_samples_split': 5, 'n_estimators': 50}
2025-04-08 06:13:14,637 - Model training complete
2025-04-08 06:13:14,637 - Evaluating model for market_regime...

Results for market_regime prediction:
Accuracy: 0.9076

Classification Report:
              precision    recall  f1-score   support

           0       0.42      0.80      0.55        49
           1       0.97      0.85      0.90       357
           2       1.00      1.00      1.00       287

    accuracy                           0.91       693
   macro avg       0.80      0.88      0.82       693
weighted avg       0.94      0.91      0.92       693

2025-04-08 06:13:14,766 - Plotting feature importance...
2025-04-08 06:13:14,938 - Saving model for market_regime...
2025-04-08 06:13:14,941 - Model saved to models/Classification/market_regime
2025-04-08 06:13:14,941 - Completed market_regime prediction using select_k_best

Model Comparison:
next_day_direction_pca: Accuracy = 0.4545
next_day_direction_select_k_best: Accuracy = 0.5483
market_regime_pca: Accuracy = 0.8831
market_regime_select_k_best: Accuracy = 0.9076